import{r as l,j as s,L as A,M as w}from"./index-DfTtE7Kw.js";const N="_container_1v2ms_1",C="_header_1v2ms_10",$="_tabs_1v2ms_23",M="_tab_1v2ms_23",P="_tabActive_1v2ms_48",E="_inputSection_1v2ms_54",I="_textarea_1v2ms_60",T="_btn_1v2ms_77",G="_spin_1v2ms_103",L="_error_1v2ms_111",R="_suggestions_1v2ms_120",q="_suggestionBtn_1v2ms_127",B="_resultSection_1v2ms_144",e={container:N,header:C,tabs:$,tab:M,tabActive:P,inputSection:E,textarea:I,btn:T,spin:G,error:L,suggestions:R,suggestionBtn:q,resultSection:B},K=["Meta-Analysis","Anomalies","Patterns","ML Predictions","Knowledge Graph","Search"];function z({apiUrl:n}){const[r,x]=l.useState("Meta-Analysis"),[m,g]=l.useState(!1),[_,h]=l.useState(""),[v,p]=l.useState(""),[a,b]=l.useState(""),S={"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},o=async(t,u,k="POST")=>{g(!0),p(""),h("");try{const i={method:k,headers:S};u&&(i.body=JSON.stringify(u));const d=await fetch(t,i);if(!d.ok)throw new Error(`${d.status} ${d.statusText}`);const c=await d.json();h(c.result||c.analysis||c.response||c.content||JSON.stringify(c,null,2))}catch(i){p(i instanceof Error?i.message:"Request failed")}finally{g(!1)}},f=()=>{if(!(!a.trim()&&r!=="Anomalies"))switch(r){case"Meta-Analysis":return o(`${n}/klaus/imi/meta-analysis`,{question:a,datasets:a});case"Anomalies":return o(`${n}/klaus/imi/anomalies${a.trim()?"/"+encodeURIComponent(a.trim()):""}`,void 0,"GET");case"Patterns":return o(`${n}/klaus/imi/patterns/all`,void 0,"GET");case"ML Predictions":return o(`${n}/klaus/imi/ml/predict`,{features:a});case"Knowledge Graph":return o(`${n}/klaus/imi/graph/search?q=${encodeURIComponent(a)}`,void 0,"GET");case"Search":return o(`${n}/klaus/imi/search?q=${encodeURIComponent(a)}`,void 0,"GET")}},y={"Meta-Analysis":["Cross-dataset brand health synthesis","Compare awareness vs purchase intent trends"],Anomalies:["","automotive"],Patterns:["Brand trust patterns","Campaign decay rates"],"ML Predictions":["Predict next quarter NPS by brand","Churn risk segmentation"],"Knowledge Graph":["brand health","campaign effectiveness"],Search:["brand health","NPS benchmark"]},j={"Meta-Analysis":"Describe datasets or ask a cross-study question...",Anomalies:"Dataset name (leave empty for default)...",Patterns:"What patterns are you looking for?","ML Predictions":"Enter features or describe what to predict...","Knowledge Graph":"Search term to explore relationships...",Search:"Search across all IMI data..."};return s.jsxs("div",{className:e.container,children:[s.jsxs("div",{className:e.header,children:[s.jsx("h1",{children:"Insights"}),s.jsx("p",{children:"AI-powered analysis across 55+ years of consumer research"})]}),s.jsx("div",{className:e.tabs,children:K.map(t=>s.jsx("button",{className:`${e.tab} ${r===t?e.tabActive:""}`,onClick:()=>{x(t),h(""),p("")},children:t},t))}),s.jsxs("div",{className:e.inputSection,children:[s.jsx("textarea",{className:e.textarea,placeholder:j[r],value:a,onChange:t=>b(t.target.value),rows:3}),s.jsxs("button",{className:e.btn,onClick:f,disabled:m,children:[m?s.jsx(A,{size:16,className:e.spin}):null,m?"Analyzing...":`Run ${r}`]}),s.jsx("div",{className:e.suggestions,children:y[r]?.map((t,u)=>s.jsx("button",{className:e.suggestionBtn,onClick:()=>{b(t)},children:t||"(default dataset)"},u))})]}),v&&s.jsx("div",{className:e.error,children:v}),_&&s.jsx("div",{className:e.resultSection,children:s.jsx(w,{content:_})})]})}export{z as default};
